LIBRARY ieee;
USE ieee.std_logic_1164.ALL;

ENTITY reg_32 IS
	PORT(
		BusMuxOut, MDatain: IN STD_LOGIC_VECTOR(31 DOWNTO 0);
		ReadChannel : IN STD_LOGIC; 
		clk, clr, MDRin : IN STD_LOGIC;
		BusMuxIn : OUT STD_LOGIC_VECTOR(31 DOWNTO 0));
END ENTITY reg_32;

ARCHITECTURE arc OF reg_32 IS
BEGIN
	variable MDRMuxOut: STD_LOGIC_VECTOR(31 DOWNTO 0);
	MDRMuxOut <= BusMuxOut when (ReadChannel = "0")
				 else Mdatain when (ReadChannel = "1");
	
	SingleRegister:
	PROCESS (clk, clr, Rin, BusMuxOut)
	BEGIN
		IF (rising_edge(clk) AND (MDRin = '1')) THEN
			IF (clr = '0') THEN
				BusMuxIn <= (others => '0' );
			ELSE
				BusMuxIn <= MDRMuxOut;
			END IF;
		END IF;
	END PROCESS;
END ARCHITECTURE arc;